# NLP_NewsTextClassification
# 中文新闻分类系统

## 项目概述

本项目是一个基于深度学习的中文新闻文本分类系统，使用BERT预训练模型进行迁移学习，实现对14个类别的中文新闻文本进行自动分类。项目针对长文本分类问题设计了特殊的处理机制，并采用了多种优化策略提高模型性能。

## 数据说明

数据集包含以下文件：
- `train_set.csv`：训练集，包含200,000条带标签的新闻文本
- `test_a.csv`：测试集A，包含50,000条无标签的新闻文本
- `test_b.csv`：测试集B，包含50,000条无标签的新闻文本

数据特点：
- 14个新闻类别，类别分布不均衡（科技类最多，星座类最少）
- 文本长度差异大，需要特殊处理长文本
- 文本已经过预处理，转换为ID序列形式

## 模型架构

项目采用基于BERT的深度学习模型：
1. **预处理层**：
   - 文本分段处理（最大长度512，最多2个段）
   - 使用Masking和Lambda层重塑输入

2. **特征提取层**：
   - 使用BERT预训练模型提取文本特征
   - 针对长文本设计的多段文本处理机制

3. **特征聚合层**：
   - 自定义Attention层聚合多段文本特征
   - Dropout层防止过拟合

4. **分类层**：
   - 全连接层映射到14个类别
   - Softmax激活函数输出类别概率

## 优化策略

1. **预训练优化**：
   - 使用RoBERTa式预训练方法适应中文新闻领域
   - 实现全词Mask预训练策略提高语言理解能力

2. **训练优化**：
   - 5折交叉验证增强模型鲁棒性
   - 梯度累积(grad_accum_steps=64)处理大批量
   - 对抗训练(adversarial_training)提高泛化能力
   - 早停、学习率衰减等策略防止过拟合

3. **预测优化**：
   - 使用5个交叉验证模型的平均结果提高稳定性
   - 使用宏平均F1分数(macro F1)作为评估指标，解决类别不平衡问题

## 使用方法

### 环境配置
```
pip install -r requirements.txt
```

### 数据探索
```
jupyter notebook EDA.ipynb
```

### 预训练模型
```
python pretraining.py
```

### 模型训练
```
python train.py
```

### 模型预测
```
python pred.py
```

## 项目结构

```
NLP新闻分类学习赛/
├── data/                      # 数据目录
│   ├── train_set.csv          # 训练集
│   ├── test_a.csv             # 测试集A
│   └── test_b.csv             # 测试集B
├── bert-base/                 # BERT预训练模型
├── corpus_tfrecord/           # 预训练语料
├── EDA.ipynb                  # 数据探索分析
├── data_utils.py              # 数据处理工具
├── train.py                   # 模型训练脚本
├── pred.py                    # 模型预测脚本
├── pretraining.py             # 预训练脚本
├── requirements.txt           # 项目依赖
└── submission.csv             # 预测结果提交文件
```

## 核心创新点

1. **长文本处理机制**：通过文本分段和注意力聚合机制，有效处理超出BERT长度限制的新闻文本
2. **领域适应预训练**：针对中文新闻领域特点，使用全词Mask策略进行二次预训练
3. **多模型集成**：使用交叉验证训练多个模型并集成，提高预测稳定性
4. **对抗训练**：通过对抗样本增强模型鲁棒性和泛化能力

## 性能指标

- 在交叉验证集上的宏平均F1分数：0.97+
- 在测试集A上的宏平均F1分数：0.96+
- 在测试集B上的宏平均F1分数：0.96+

## 依赖库

- tensorflow >= 2.0.0
- keras >= 2.3.1
- bert4keras >= 0.7.7
- pandas >= 1.0.0
- numpy >= 1.18.0
- scikit-learn >= 0.22.0
- tqdm >= 4.43.0
- jupyter >= 1.0.0
- matplotlib >= 3.2.0
- seaborn >= 0.10.0 
